import{d as U,x as q,y as w,B as D,a as C,e as S,b as e,C as I,s as j,j as R,k as _,D as L,o as z,l as A,g as V,w as E,u as a,t as n,M as u,m,v as f,E as M,F as N,r as T}from"./index-BX7TXqV0.js";import{_ as W}from"./FormContainer.vue_vue_type_script_setup_true_lang-Df0427Rg.js";const J={class:"d-flex flex-wrap justify-content-center align-items-center mb-2"},O=["for"],P=["src"],Y={class:"flex"},G=["id","name"],H=U({__name:"InputImage",props:{id:String,name:String,value:[String,File],defaultImage:String,imgClass:String},emits:["loadFile"],setup(r,{emit:s}){const l=r,t=s,h=q(null),c=q(""),v=w(()=>c.value?c.value:l.defaultImage?l.defaultImage:"/assets/images/camera.png");function x(g){let b=new FileReader;b.onload=d=>{d.target&&(c.value=d.target.result)},b.readAsDataURL(g)}function y(g){let d=g.target.files;d&&d.length>0&&(x(d[0]),t("loadFile",d[0]))}return D(l,()=>{c.value&&!l.value&&(c.value="",h.value.value="")}),(g,b)=>(C(),S("div",null,[e("div",J,[e("label",{for:r.id},[e("img",{class:I(["cursor-pointer shadow-sm d-flex justify-content-center align-items-center border border-1",r.imgClass]),src:v.value,alt:"picture",style:{width:"125px",height:"125px"}},null,10,P)],8,O)]),e("div",Y,[e("input",{id:r.id,name:r.name,ref_key:"inputRef",ref:h,type:"file",class:"file",accept:"image/png, image/jpeg",onChange:y},null,40,G)])]))}}),$=j("categories",()=>{const r=q(null),s=w(()=>!!(r.value&&r.value.length>0)),l=w(()=>r.value);function t(h){r.value={...r.value,...h}}return{hasCategories:s,getCategories:l,setCategories:t}});function K({onSuccess:r,onError:s}){const l=$();axios.get("/categories").then(t=>{l.setCategories(t.data.data),r&&r()}).catch(t=>{s&&s(),iziToast.error({title:"Error",message:"Não foi possivel carregar as categorias."})})}const Q={class:"w-100 d-flex flex-wrap gap-1 bookcase-form"},X={class:"w-100 mb-3"},Z={class:"text-danger"},ee={class:"mb-3 bookcase-input-container"},te=e("label",{for:"title",class:"form-label"},"Título",-1),ae={class:"text-danger"},se={class:"mb-3 bookcase-input-container"},oe=e("label",{for:"author",class:"form-label"},"Author",-1),re={class:"text-danger"},ie={class:"mb-3 bookcase-input-container"},le=e("label",{for:"isbn",class:"form-label"},"ISBN",-1),ne={class:"text-danger"},de={class:"mb-3 bookcase-input-container"},ue=e("label",{for:"number_pages",class:"form-label"},"Número de páginas",-1),ce={class:"text-danger"},me={class:"mb-3 bookcase-input-container"},ge=e("label",{for:"language",class:"form-label"},"Idioma",-1),be={class:"text-danger"},pe={class:"mb-3 bookcase-input-container"},fe=e("label",{for:"publisher",class:"form-label"},"Editora",-1),he={class:"text-danger"},_e={class:"mb-3 w-100"},ve=e("label",{for:"language",class:"form-label"},"Categoria",-1),xe=["value"],ye={class:"text-danger"},ke={class:"mb-3 w-100"},Ce=e("label",{for:"description",class:"form-label"},"Descrição",-1),Se={class:"text-danger"},qe={class:"d-flex justify-content-end col-12"},we=["disabled"],Ve=U({__name:"FormBook",props:{book:Object,method:{type:String,required:!0},url:{type:String,required:!0}},setup(r){var c,v,x,y,g,b,d,F;const s=r,l=$(),t=R({thumb:void 0,title:((c=s==null?void 0:s.book)==null?void 0:c.title)??void 0,author:((v=s==null?void 0:s.book)==null?void 0:v.author)??void 0,isbn:((x=s==null?void 0:s.book)==null?void 0:x.isbn)??void 0,description:((y=s==null?void 0:s.book)==null?void 0:y.description)??void 0,number_pages:((g=s==null?void 0:s.book)==null?void 0:g.number_pages)??void 0,language:((b=s==null?void 0:s.book)==null?void 0:b.language)??void 0,publisher:((d=s==null?void 0:s.book)==null?void 0:d.publisher)??void 0,category_id:((F=s==null?void 0:s.book)==null?void 0:F.category)??void 0});t.defineYupRules({title:_().min(3,"title.min").max(255,"title.max").required("title.required"),author:_().min(3,"author.min").max(255,"author.max").required("author.required"),isbn:_().min(10,"isbn.min").max(20,"isbn.max").required("isbn.required"),description:_().min(3,"description.min").max(500,"description.max").required("description.required"),number_pages:L().min(1,"number_page.min_digits").max(2e3,"number_pages.max_digits").required("number_pages.reuired"),language:_().min(2,"language.min").max(2,"language.max").required("language.required"),publisher:_().min(3,"publisher.min").max(255,"publisher.max").required("publisher.required"),category_id:L().required("category.required")});async function h(){t.submit({method:s.method,url:s.url,headers:{"Content-Type":"multipart/form-data"},onSuccess(k){s.method.toLocaleLowerCase()=="post"&&t.resetData(),iziToast.success({title:"Sucesso",message:u.success(k.data.message??"")})},onError(k){console.log(k)}})}return z(()=>{l.hasCategories||K({onSuccess:()=>{t.data.category_id=l.getCategories[0].id}})}),(k,i)=>{const p=A("max-length");return C(),S("section",null,[V(W,{title:r.method.toLocaleLowerCase()=="post"?"Adicionar Livro":"Atualizar informações do Livro","handle-submit":h},{default:E(()=>[e("div",Q,[e("div",X,[V(H,{onLoadFile:i[0]||(i[0]=o=>a(t).data.thumb=o)}),e("small",Z,n(a(u).error(a(t).errors.thumb)),1)]),e("div",ee,[te,m(e("input",{"onUpdate:modelValue":i[1]||(i[1]=o=>a(t).data.title=o),type:"text",class:"form-control",id:"title",placeholder:"Carlos De Souza",autocomplete:"title"},null,512),[[f,a(t).data.title],[p,255]]),e("small",ae,n(a(u).error(a(t).errors.title)),1)]),e("div",se,[oe,m(e("input",{"onUpdate:modelValue":i[2]||(i[2]=o=>a(t).data.author=o),type:"text",class:"form-control",id:"author",autocomplete:"author",placeholder:"William Shakespeare"},null,512),[[f,a(t).data.author],[p,255]]),e("small",re,n(a(u).error(a(t).errors.author)),1)]),e("div",ie,[le,m(e("input",{"onUpdate:modelValue":i[3]||(i[3]=o=>a(t).data.isbn=o),type:"text",class:"form-control",id:"isbn",autocomplete:"isbn",placeholder:"0000000000"},null,512),[[f,a(t).data.isbn],[p,20]]),e("small",ne,n(a(u).error(a(t).errors.isbn)),1)]),e("div",de,[ue,m(e("input",{"onUpdate:modelValue":i[4]||(i[4]=o=>a(t).data.number_pages=o),type:"number",class:"form-control",id:"number_pages",autocomplete:"number_pages",placeholder:"200"},null,512),[[f,a(t).data.number_pages],[p,2e3]]),e("small",ce,n(a(u).error(a(t).errors.number_pages)),1)]),e("div",me,[ge,m(e("input",{"onUpdate:modelValue":i[5]||(i[5]=o=>a(t).data.language=o),type:"text",class:"form-control",id:"language",autocomplete:"language",placeholder:"pt"},null,512),[[f,a(t).data.language],[p,2]]),e("small",be,n(a(u).error(a(t).errors.language)),1)]),e("div",pe,[fe,m(e("input",{"onUpdate:modelValue":i[6]||(i[6]=o=>a(t).data.publisher=o),type:"text",class:"form-control",id:"publisher",autocomplete:"publisher",placeholder:"Viva Editora"},null,512),[[f,a(t).data.publisher],[p,255]]),e("small",he,n(a(u).error(a(t).errors.publisher)),1)]),e("div",_e,[ve,m(e("select",{class:"form-select form-select-lg mb-3","onUpdate:modelValue":i[7]||(i[7]=o=>a(t).data.category_id=o)},[(C(!0),S(N,null,T(a(l).getCategories,(o,B)=>(C(),S("option",{value:o.id,key:B},n(o.name),9,xe))),128))],512),[[M,a(t).data.category_id]]),e("small",ye,n(a(u).error(a(t).errors.category_id)),1)]),e("div",ke,[Ce,m(e("textarea",{"onUpdate:modelValue":i[8]||(i[8]=o=>a(t).data.description=o),type:"text",class:"form-control",id:"description",autocomplete:"description",placeholder:"Romeu e Julieta é uma tragédia escrita entre 1591 e 1595, nos primórdios da carreira literária de William Shakespeare, sobre dois adolescentes cuja morte acaba unindo suas famílias, outrora em pé de guerra. "},null,512),[[f,a(t).data.description],[p,255]]),e("small",Se,n(a(u).error(a(t).errors.description)),1)]),e("div",qe,[e("button",{class:"btn btn-primary col-12 col-lg-3 mb-2",disabled:a(t).isProcessing()},n(r.method.toLocaleLowerCase()=="post"?"Salvar":"Atualizar"),9,we)])])]),_:1},8,["title"])])}}});export{Ve as _};
